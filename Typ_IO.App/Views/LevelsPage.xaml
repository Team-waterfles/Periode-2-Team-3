<?xml version="1.0" encoding="utf-8" ?>
<ContentView
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:vm="clr-namespace:BasisJaar2.ViewModels"
    xmlns:models="clr-namespace:BasisJaar2.Models"
    x:Class="BasisJaar2.Views.LevelsPage"
    x:Name="Root"
    x:DataType="vm:LevelsViewModel">

    <ContentView.BindingContext>
        <vm:LevelsViewModel />
    </ContentView.BindingContext>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">

            <Label Text="Kies een level"
                   FontSize="28"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   Margin="0,0,0,10" />

            <CollectionView ItemsSource="{Binding Levels}"
                            Margin="0,10"
                            SelectionMode="None">

                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Level">

                        <Frame Margin="0,8"
                               Padding="12"
                               HasShadow="True"
                               CornerRadius="15">

                            <!-- âœ… Frame kleur afhankelijk van status -->
                            <Frame.Style>
                                <Style TargetType="Frame">
                                    <!-- default = locked -->
                                    <Setter Property="BackgroundColor" Value="#6e6e6e"/>

                                    <Style.Triggers>
                                        <!-- unlocked = blauw -->
                                        <DataTrigger TargetType="Frame"
                                                     Binding="{Binding IsUnlocked}"
                                                     Value="True">
                                            <Setter Property="BackgroundColor" Value="#1a3c8c"/>
                                        </DataTrigger>

                                        <!-- completed = donkerblauw -->
                                        <DataTrigger TargetType="Frame"
                                                     Binding="{Binding IsCompleted}"
                                                     Value="True">
                                            <Setter Property="BackgroundColor" Value="#0c2e6b"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Frame.Style>

                            <Grid ColumnDefinitions="Auto,*"
                                  RowDefinitions="Auto,Auto"
                                  ColumnSpacing="10">

                                <Image Grid.Row="0"
                                       Grid.Column="0"
                                       Grid.RowSpan="2"
                                       Source="{Binding IconSource}"
                                       WidthRequest="32"
                                       HeightRequest="32"
                                       VerticalOptions="Center" />

                                <Label Grid.Row="0"
                                       Grid.Column="1"
                                       Text="{Binding Naam}"
                                       FontAttributes="Bold"
                                       FontSize="20"
                                       TextColor="White" />

                                <Label Grid.Row="1"
                                       Grid.Column="1"
                                       Text="{Binding Beschrijving}"
                                       FontSize="14"
                                       TextColor="#dddddd"
                                       Margin="0,0,0,4" />

                                <Button Grid.Row="1"
                                        Grid.Column="1"
                                        Text="Start level"
                                        HeightRequest="42"
                                        HorizontalOptions="FillAndExpand"
                                        Margin="0,24,0,0"
                                        FontSize="14"
                                        Command="{Binding Path=BindingContext.StartLevelCommand, Source={x:Reference Root}}"
                                        CommandParameter="{Binding .}">

                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <!-- default = unlocked -->
                                            <Setter Property="BackgroundColor" Value="#0c2e6b"/>
                                            <Setter Property="TextColor" Value="White"/>
                                            <Setter Property="CornerRadius" Value="8"/>
                                            <Setter Property="IsEnabled" Value="True"/>

                                            <Style.Triggers>
                                                <!-- locked button -->
                                                <DataTrigger TargetType="Button"
                                                             Binding="{Binding IsUnlocked}"
                                                             Value="False">
                                                    <Setter Property="BackgroundColor" Value="#d3d3d3"/>
                                                    <Setter Property="TextColor" Value="#555"/>
                                                    <Setter Property="IsEnabled" Value="False"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>

                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>

            </CollectionView>

        </VerticalStackLayout>
    </ScrollView>
</ContentView>
